{% extends "base.html" %}
{% block content %}
<div class="container">
  <!-- ✅ Page heading -->
  <h1>Our Products</h1>

  <!-- ✅ Use existing global grid + card classes -->
  <div id="products-list" class="grid">
    <!-- Products will be dynamically inserted here -->
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", async () => {
    try {
      const res = await fetch("/api/products");
      if (!res.ok) {
        document.querySelector("#products-list").innerHTML = "<p>Failed to load products.</p>";
        return;
      }

      const products = await res.json();
      const listContainer = document.querySelector("#products-list");
      listContainer.innerHTML = ""; // Clear any existing content

      products.forEach(p => {
        const card = document.createElement("div");
        card.classList.add("card"); // ✅ Use global card styling

        // Optional product image
        const imageTag = p.image_url
          ? `<div class="card-media"><img src="${p.image_url}" alt="${p.name}"></div>`
          : "";

        // ✅ Match card-body structure already styled in styles.css
        card.innerHTML = `
          ${imageTag}
          <div class="card-body">
            <h3><a href="/product/${p.id}">${p.name}</a></h3>
            <p>${p.description || ""}</p>
            <p class="price">$${(p.price_cents / 100).toFixed(2)}</p>
          </div>
        `;

        listContainer.appendChild(card);
      });

    } catch (err) {
      console.error("Error loading products:", err);
      document.querySelector("#products-list").innerHTML = "<p>Error loading products.</p>";
    }
  });
</script>
{% endblock %}







