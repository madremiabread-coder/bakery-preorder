{% extends "base.html" %}
{% block content %}
<div class="container">
  <h1>Our Products</h1>
  <div id="products-list" class="products-grid">
    <!-- Products will be dynamically inserted here -->
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", async () => {
    try {
      const res = await fetch("/api/products");
      if (!res.ok) {
        document.querySelector("#products-list").innerHTML = "<p>Failed to load products.</p>";
        return;
      }

      const products = await res.json();

      const listContainer = document.querySelector("#products-list");
      listContainer.innerHTML = ""; // clear any existing content

      products.forEach(p => {
        const card = document.createElement("div");
        card.classList.add("product-card");

        // Link to dynamic product detail page
        card.innerHTML = `
          <h3><a href="/product/${p.id}">${p.name}</a></h3>
          <p>${p.description || ""}</p>
          <p><strong>Price:</strong> $${(p.price_cents / 100).toFixed(2)}</p>
        `;

        listContainer.appendChild(card);
      });
    } catch (err) {
      console.error("Error loading products:", err);
      document.querySelector("#products-list").innerHTML = "<p>Error loading products.</p>";
    }
  });
</script>

<style>
  /* Some simple styling */
  .products-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 1.5rem;
  }
  .product-card {
    border: 1px solid #ddd;
    padding: 1rem;
    border-radius: 8px;
    background: #fafafa;
  }
  .product-card h3 {
    margin-top: 0;
  }
</style>
{% endblock %}




