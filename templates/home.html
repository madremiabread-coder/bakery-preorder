{% extends "base.html" %}
{% block content %}
<div class="container">
  <h1>Welcome to Our Sourdough Shop</h1>
  <p>Freshly baked sourdough breads and more. Check out our featured items:</p>

  <div id="featured-list" class="featured-grid">
    <!-- Featured products will load dynamically -->
  </div>

  <p><a href="/products">See all products â†’</a></p>
</div>

<script>
  document.addEventListener("DOMContentLoaded", async () => {
    try {
      const res = await fetch("/api/products");
      if (!res.ok) {
        document.querySelector("#featured-list").innerHTML = "<p>Failed to load featured products.</p>";
        return;
      }

      const products = await res.json();
      const featured = products.slice(0, 2); // take first two items as featured

      const listContainer = document.querySelector("#featured-list");
      listContainer.innerHTML = "";

      featured.forEach(p => {
        const card = document.createElement("div");
        card.classList.add("featured-card");

        card.innerHTML = `
          <h3><a href="/product/${p.id}">${p.name}</a></h3>
          <p>${p.description || ""}</p>
          <p><strong>Price:</strong> $${(p.price_cents / 100).toFixed(2)}</p>
        `;

        listContainer.appendChild(card);
      });
    } catch (err) {
      console.error("Error loading featured products:", err);
      document.querySelector("#featured-list").innerHTML = "<p>Error loading featured products.</p>";
    }
  });
</script>

<style>
  .featured-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 1.5rem;
    margin-top: 1rem;
  }
  .featured-card {
    border: 2px solid #ccc;
    padding: 1rem;
    border-radius: 10px;
    background: #fffdf5;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
  }
  .featured-card h3 {
    margin-top: 0;
  }
</style>
{% endblock %}


